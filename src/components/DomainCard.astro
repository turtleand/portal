---
import type { CopyToken } from "../utils/i18n";

interface Props {
  labelCopy: CopyToken;
  emoji: string;
  taglineCopy: CopyToken;
  href: string;
  variant: "ai" | "growth" | "build" | "blockchain";
  delay?: number;
  image?: string;
}

const {
  labelCopy,
  emoji,
  taglineCopy,
  href,
  variant,
  delay = 0,
  image,
}: Props = Astro.props;
const backgroundClasses = {
  ai: "bg-card-ai",
  growth: "bg-card-growth",
  build: "bg-card-build",
  blockchain: "bg-card-blockchain",
};
const hasImage = Boolean(image);
const animationDelay = `${delay}ms`;
const imageState = hasImage ? "pending" : "false";
---

<a
  href={href}
  class:list={{
    "card-surface": true,
    group: true,
    "focus:outline-none": true,
    "focus-visible:ring-2": true,
    "focus-visible:ring-offset-2": true,
    "focus-visible:ring-accent": true,
    "focus-visible:ring-offset-deepBlue": true,
  }}
>
  <div
    class:list={{
      "card-content": true,
      flex: true,
      "h-full": true,
      "flex-col": true,
      "justify-between": true,
      "p-8": true,
      "transition-transform": true,
      "animate-fadeUp": true,
      [backgroundClasses[variant] ?? "bg-card-ai"]: true,
    }}
    data-domain-card
    data-variant={variant}
    data-has-image={hasImage ? "true" : "false"}
    data-image-ready={imageState}
    style={`animation-delay: ${animationDelay};`}
  >
    {
      hasImage && (
        <img
          class="card-media"
          src={image}
          alt=""
          loading="eager"
          fetchpriority="high"
          decoding="async"
          aria-hidden="true"
          onload="this.closest('[data-domain-card]').dataset.imageReady = 'true';"
          onerror="this.closest('[data-domain-card]').dataset.imageReady = 'false'; this.remove();"
        />
      )
    }
    <div class="card-body flex flex-col gap-5 pt-2">
      <span class="domain-emoji" aria-hidden="true">{emoji}</span>
      <div class="space-y-3 text-left">
        <h2
          class="font-heading text-[1.85rem] md:text-[2rem] leading-tight font-semibold tracking-[0.04em] text-white drop-shadow-[0_8px_32px_rgba(0,0,0,0.65)]"
          data-i18n-key={labelCopy.key}
        >
          {labelCopy.text}
        </h2>
        <p
          class="text-base text-white/80 leading-relaxed max-w-[32ch] font-normal drop-shadow-[0_5px_24px_rgba(0,0,0,0.55)]"
          data-i18n-key={taglineCopy.key}
        >
          {taglineCopy.text}
        </p>
      </div>
    </div>
  </div>
</a>
