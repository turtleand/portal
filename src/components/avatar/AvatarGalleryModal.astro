---
import AvatarGallery from './AvatarGallery.astro';
import modalControllerModule from './modal-controller.js?url';
import { createTranslator } from '../../utils/i18n';
import type { Locale } from '../../utils/i18n';

interface Props {
  locale: Locale;
}

const { locale = 'en' }: Partial<Props> = Astro.props;
const t = createTranslator(locale);
const modalId = 'avatar-gallery-modal';
const badgeLabel = t('avatar.modal.badgeLabel');
const closeLabel = t('avatar.modal.closeLabel');
const modalAriaLabel = t('avatar.modal.ariaLabel');
---

<div
  id={modalId}
  class="pointer-events-none fixed inset-0 z-[70] hidden"
  data-avatar-modal
  aria-hidden="true"
>
  <div
    class="absolute inset-0 bg-black/70 backdrop-blur-sm transition-opacity duration-300"
    data-avatar-modal-overlay
  ></div>
  <div
    class="relative z-10 flex min-h-full items-start justify-center overflow-y-auto p-4 sm:items-center sm:p-6"
  >
    <div
      class="w-full max-w-6xl rounded-2xl border border-white/15 bg-gradient-to-br from-[#1b2a3f] via-[#0c1627] to-[#050b16] p-5 shadow-[0_45px_160px_rgba(2,6,15,0.85)] transition-transform duration-300 max-h-[90vh] overflow-y-auto sm:rounded-[2.5rem] sm:p-8"
      role="dialog"
      aria-modal="true"
      aria-label={modalAriaLabel}
      data-i18n-key="avatar.modal.ariaLabel"
      data-i18n-attr="aria-label"
      data-avatar-modal-panel
      tabindex="-1"
    >
      <div class="flex items-center justify-between gap-4 pb-4">
        <p
          class="text-sm uppercase tracking-[0.16em] text-offWhite/80"
          data-i18n-key="avatar.modal.badgeLabel"
        >
          {badgeLabel}
        </p>
        <button
          type="button"
          class="rounded-full border border-white/30 px-5 py-2 text-sm uppercase tracking-[0.18em] text-offWhite transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent"
          data-avatar-modal-close
          data-i18n-key="avatar.modal.closeLabel"
        >
          {closeLabel}
        </button>
      </div>
      <AvatarGallery locale={locale} />
    </div>
  </div>
</div>
<script type="module" src={modalControllerModule}></script>
